:toc: macro
:toc-title: Tabla de Contenidos
:toclevels: 3

# https://github.com/wren-lang/wren[_Wren]_ Adventures

En este peque√±o documento se detallar√°n lo b√°sico del lenguaje de programaci√≥n http://wren.io[Wren]. 

Escrito por https://ninjas.cl[Camilo Castro] y https://github.com/ninjascl/wren-adventures/graphs/contributors[colaboradores]. Para https://ninjas.cl[Ninjas.cl].

Esta obra est√° bajo una http://creativecommons.org/licenses/by-nc-sa/4.0/[Licencia Creative Commons Atribuci√≥n-No-Comercial-Compartir-Igual 4.0 Internacional]

http://creativecommons.org/licenses/by-nc-sa/4.0/[image:https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png[Licencia Creative Commons]]

toc::[]

## Peque√±a Historia de https://github.com/wren-lang/wren[_Wren]_

https://github.com/wren-lang/wren[_Wren]_ es un lenguaje de programaci√≥n https://es.wikipedia.org/wiki/Programaci%C3%B3n_orientada_a_objetos[orientado a objetos] creado por http://journal.stuffwithstuff.com/[Bob Nystrom], un ex desarrollador de videojuegos y creador de otros lenguajes de programaci√≥n como https://github.com/munificent/vigil[Vigil], http://finch.stuffwithstuff.com/[Finch] y http://magpie-lang.org/[Magpie]. Ha escrito dos libros: http://gameprogrammingpatterns.com/[Game Programming Patterns] y http://craftinginterpreters.com/[Crafting Interpreters]. 

El primer _commit_ de _Wren_ fue escrito el https://github.com/wren-lang/wren/tree/2f6a6889f1b4a1ba86aeb169e7398704b1ee04c0[22 de Octubre del 2013] y su versi√≥n m√°s reciente es la _0.3_. Actualmente _Bob Nystrom_ pas√≥ a ser colaborador y la evoluci√≥n del lenguaje fue asignada a https://github.com/underscorediscovery[_discovery] (creador del https://luxeengine.com[game engine Luxe]).

_Wren_ fue creado como una alternativa a _Lua_ y otros https://en.wikipedia.org/wiki/Scripting_language[lenguajes de scripting] para personas que estuvieran m√°s familiarizadas con lenguajes orientados a objetos como _Java_, _C#_, o _C++_. Su principal foco es la simpleza.

La p√°gina oficial de Wren es http://wren.io[Wren.io].

### ¬øQu√© es un _Wren_?

_Wren_ es una https://es.wikipedia.org/wiki/Troglodytidae[tipo de ave peque√±a] perteneciente a la familia de los troglod√≠tidos. En Chile tenemos al https://www.avesdechile.cl/074.htm[Cherc√°n o Chochin Criollo].

image:https://user-images.githubusercontent.com/292738/77261969-2240d580-6c71-11ea-93d0-4341e82c2f92.png[Chochin Criollo - Fotograf√≠a por Juan Tassara B.]

> Fotograf√≠a por Juan Tassara B en https://www.avesdechile.cl.


## ¬øC√≥mo usar Wren?

_Wren_ es un lenguaje interpretado, lo que significa que no requiere de compilaci√≥n. Basta simplemente tener un int√©rprete para ejecutar los algoritmos. Hay varias alternativas.

1. https://github.com/wren-lang/wren[Compilar tu propio int√©rprete de _Wren_]. Esta es la opci√≥n para valientes.

2. https://github.com/wren-lang/wren-cli/releases[Utiliza _Wren CLI_] para ejecutar archivos _*.wren_.

3. Utiliza un engine de juegos como https://domeengine.com/[_Dome_], https://tic.computer[_TIC 80_] o https://luxeengine.com/alpha/[_Luxe_] que traen _Wren_ listo para llegar y utilizar.

4. Utiliza http://ppvk.github.io/wren-nest/[_Wren Nest_] para probar el lenguaje en tu navegador. (Puede que no tenga las √∫ltimas novedades).

Una vez que tengas tu int√©rprete instalado puedes ejecutar `wren main.wren` para ver el resultado de tu script.

## Nociones B√°sicas

### Saltos de l√≠nea

_Wren_ utiliza los saltos de l√≠nea (`\n`), por lo que no es necesario utilizar el punto y coma (`;`) para separar instrucciones. Sin embargo omite los saltos de l√≠nea si la instrucci√≥n espera m√°s informaci√≥n para ser v√°lida.

#### Ejemplo: Lista de elementos

```js
var animales = [
  "perro",
  "gato",
  "condor",
  "huemul"
]
```

#### Ejemplo: Par√°metros de un m√©todo

```js
 MiClase.metodo(
       parametro1,
       parametro2,
       parametro3
 )
```

#### Ejemplo: Generar un n√∫mero al azar del 0 al 9

Al considerar los saltos de l√≠nea significativos, 
provoca un comportamiento inusual al momento de llamar m√©todos.

Instrucci√≥n en una sola l√≠nea.

```js
Random.new().int(10)
```

Esto no es v√°lido en _Wren_ (Pero si es v√°lido en la mayor√≠a de los lenguajes de programaci√≥n).

```js
Random
.new()
.int(10)
```

Para ser v√°lido necesitamos poner un punto al final de la l√≠nea.

```js
Random.
new().
int(10)
```

Este comportamiento inusual espera ser reparado en la versi√≥n `0.4`.

#### Ejemplo: *Error*

La siguiente l√≠nea arroja error debido a que no tiene un salto de l√≠nea o una operaci√≥n.

```js
Random.new().int(10) Random.new().int(10)
```

### Palabras Reservadas

_Wren_ es un lenguaje simple y peque√±o. Sus palabras reservadas son las siguientes:

```js
break class construct else false for foreign if import 
in is null return static super this true var while
```

#### Caracteres Significativos

- Caracteres comunes (`+ - * / % < > = ! ( ) [ ] | . " { } , & ^ ? : ~ _`)
- Retorno de carro (`\n`)

### Comentarios

Los comentarios utilizan la misma sintaxis que el https://es.wikipedia.org/wiki/C_(lenguaje_de_programaci%C3%B3n)[`Lenguaje de Programaci√≥n C`].

Los s√≠mbolos son los siguientes: `/* */` (multi l√≠nea) y `//` (l√≠nea √∫nica).

```

// Comentario de una sola l√≠nea

/*
Este comentario 
tiene m√∫ltiples
l√≠neas
*/
```

Se pueden anidar los comentarios. √∫til para comentar c√≥digo que ya tenga comentarios.

```
/*
Este comentario 
tiene m√∫ltiples
l√≠neas.
  /* Tambi√©n puedes incluir comentarios, 
  dentro de comentarios multi l√≠nea. 
  */
*/
```

#### Tip: Comentarios Tijera

Puedes combinar los comentarios de una sola l√≠nea con los de m√∫ltiples l√≠neas para
comentar/descomentar r√°pidamente secciones de c√≥digo. Se llaman comentarios tijera
por que pueden "cortar" un c√≥digo para no ser ejecutado.

```js
// /*
   codigo()
// */
```

Al eliminar el comentario de la primera l√≠nea, el c√≥digo ser√° comentado. De esta forma r√°pidamente
puedes activar o desactivar secciones de c√≥digo.

```js
/*
   codigo()
// */
```

Puede a√∫n ser m√°s simplificado de esta forma

```js
//*
   codigo()
// */
```

Si se elimina el primer `/` el c√≥digo ser√° comentado. Por lo que se ahorra un par de movimientos al realizar el comentario.

```js
/*
   codigo()
// */
```
#### Tip: Comentarios de par√°metros

En _Wren_ no es posible llamar a los par√°metros por su nombre. Por lo que si utilizas una funci√≥n
con algunos par√°metros, puede ser √∫til comentarlos.

```js
circulo(/* x */ 10, /* y */ 20, /* radio */ 10)
```

### Identificadores

Similar al _Lenguaje C_, para los indentificadores (nombres de variables, clases, metodos, funciones) se pueden utilizar los caracteres de la http://www.asciitable.com/[lista `ascii`] y comenzar con un caracter alfab√©tico o gui√≥n bajo. Los identificadores en _Wren_ diferencian entre may√∫sculas y min√∫sculas. Solo se permiten letras (`A - Z`, `a - z`), n√∫meros (`0 - 9`) y gui√≥n bajo (`_`). No se permiten espacios o comenzar con un n√∫mero.

#### Ejemplo de Identificadores v√°lidos

```js
hola 
camelCase 
PascalCase 
_under_score 
abc123 
TODAS_MAYUSCULAS
```

#### Ejemplo de Identificadores no v√°lidos

```
13hola 
mi-variable
$miVariable 
mi variable
√±and√∫
üë®miMetodo
Miüë©clase
```

#### Unicode

No est√°n permitidos caracteres https://es.wikipedia.org/wiki/UTF-8[UTF-8] como la `√ë` o los emojis en los identificadores. Sin embargo las `Strings` las soportan en su contenido sin problemas. Hay lenguajes como https://swift.org/[_Swift_] o https://www.emojicode.org/[Emoji Code] que si soportan identificadores con emojis, aunque la utilidad de esta pr√°ctica es debatible.

Ejemplo de EmojiCode

```
üèÅ üçá
  üòÄ üî§Hello World!üî§‚ùóÔ∏è
üçâ
```

#### Identificadores con Gui√≥n Bajo

Un caso especial es para los identificadores con gui√≥n bajo como `_color` (un gui√≥n bajo al principio) y `__sabor` (dos guiones bajos al principio). Con un gui√≥n bajo indica que es una propiedad de instancia, mientras que con dos guiones bajos indican que es una propiedad de clase. M√°s detalles en la secci√≥n de Clases.

### Strings

Las cadenas de caracteres son delimitadas por las comillas dobles (`"`). Pueden ser de una sola l√≠nea o multi l√≠nea. En el caso de ser multi l√≠nea, estas conservar√°n todos los caracteres de espacio y salto de l√≠nea contenidos en el _string_. El caracter de comilla simple (`'`) no es significativo para _Wren_.

Las strings pueden contener caracteres unicode en http://utf8everywhere.org/[UTF-8].

#### String de una l√≠nea

```js
"Solo es necesario comillas dobles"
```

#### String multi l√≠nea

_Wren_ permite string multi l√≠neas utilizando el mismo caracter de comillas dobles (`"`) de las strings de una sola l√≠nea. 

```js
"
 Todo esto es una string multi l√≠nea
 Wren esperar√° hasta que aparezca 
 la siguiente comilla doble.
 Los strings multi l√≠nea en Wren guardan tanto espacios como saltos de l√≠nea en su interior.
 (no son omitidos).
"
```

#### Contando el largo del string

Si utilizamos la propiedad `count` podremos obtener el largo de un string.

Por ejemplo `"hola".count` devolver√° `4`. Hay que tener cuidado con los caracteres unicode (emojis), ya que el largo depender√° de lo que se est√© contando. _Wren_ cuenta las unidades de c√≥digo (code unit) unicode, por que todos los strings est√°n bajo _UTF-8_ (similar al comportamiento de https://www.ruby-lang.org/en/[_Ruby_] y https://www.python.org/[_Python 3_]).

```js

System.print("a".count) // Retorna 1.
System.print("a".bytes.count) // Retorna 1 (Parte de la tabla ASCII original).

System.print("√±".count) // Retorna 1.
System.print("√±".bytes.count) // Retorna 2.

System.print("üëπ".count) // Retorna 1.
System.print("üëπ".bytes.count) // Retorna 4.

System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".count) // Retorna 7 al contar la unidades de c√≥digo de Unicode
System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".bytes.count) // Retorna 25 al contar los bytes UTF-8
```

`System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".count)` retorna 7 por que se est√° contando las unidades de c√≥digo de unicode, es decir, el emoji üë®‚Äçüë©‚Äçüëß‚Äçüë¶ est√° formado por los siguientes caracteres : üë® + caracter de uni√≥n de ancho cero + üë© + caracter de uni√≥n de ancho cero + üëß + caracter de uni√≥n de ancho cero + üë¶.

`System.print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶".bytes.count)` retorna 25 por que est√° contando los bytes necesarios para almacenar estos caracteres. bytes es una secuencia de caracteres en C, lo que permite utilizar los Strings para almacenar informaci√≥n en binario.

Hay dos formas de contar adicionales que _Wren_ no soporta. La primera es contar por unidades de c√≥digo _UTF-16_ y la otra es considerar los emojis compuestos como una unidad.

El string "üë®‚Äçüë©‚Äçüëß‚Äçüë¶" deber√≠a ser de largo 11 para la codificaci√≥n _UTF-16_. Mientras que deber√≠a ser de largo 1 si lo consideramos como un caracter singular (lo que percibe el usuario). Seg√∫n los amigos de http://utf8everywhere.org/[UTF-8 Everywhere] contar de estas formas es poco productivo, ya que lo que importa es realmente los code units (unidades de c√≥digo) _UTF-8_ que se tiene al escribir un string. Por lo que _Wren_ tiene un comportamiento adecuado. De todas formas ese tipo de conversiones y conteo podr√≠a programarse con c√≥digos externos a _Wren_. M√°s detalles en el https://www.unicode.org/glossary/[Glosario Unicode].

#### Uni√≥n e interpolaci√≥n de strings

Si deseamos unir varios strings o incluir datos dentro de ellos podemos utilizar las siguientes operaciones: `+` y `%()`.

- `"Hola" + "Mundo"`: Crea un nuevo string con la uni√≥n de `Hola` y `Mundo`. Entregar√° `HolaMundo`.
- `"Hola %(mundo)"`: Crea un string con la frase `Hola` y el contenido de la variable `mundo`.

La operaci√≥n `%()` permite incluir cualquier instrucci√≥n _Wren_ v√°lida, la cual finalmente ejecutar√° el m√©todo `toString` para ser incluido en la cadena de caracteres.

```js
System.print("La respuesta es %(20 * 2 + 2).")
```

> La respuesta es 42.


#### Caracteres de Escape

Muchas veces se necesitan escribir caracteres especiales en un string. Por ejemplo si quisieramos escribir `"Hola Mundo"` incluyendo las comillas, tendr√≠amos que escribilo de esta forma `"\"Hola Mundo\""`. Esto incluir√° los caracteres de comillas dobles en la frase.

```js
"\0" // byte NUL (Nulo) : 0.
"\"" // Comillas dobles.
"\\" // Barra invertida.
"\%" // Signo porcentaje.
"\a" // Sonido de alarma.
"\b" // Retroceso.
"\f" // Alimentaci√≥n de formularios.
"\n" // Salto de l√≠nea.
"\r" // Retorno de carro.
"\t" // Tab.
"\v" // Tab vertical.
```

Para indicar caracteres especiales podemos utilizar `\u` (unicode para letras disponibles en los idiomas humanos), `\U` (unicode para letras especiales como emoji) y `\x` (bytes sin codificar).

- `System.print("\u0041\u0b83\u00DE")` = A‡ÆÉ√û
- `System.print("\U0001F64A\U0001F680")` = üôäüöÄ
- `System.print("\x48\x69\x2e")` = Hi.



